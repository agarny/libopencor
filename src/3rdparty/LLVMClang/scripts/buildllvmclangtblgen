#!/bin/sh

LLVMCLANG_VERSION=14.0.3c

curl -Ls https://github.com/opencor/llvm-project/archive/refs/tags/llvmorg-$LLVMCLANG_VERSION.zip -o llvm-project-llvmorg-$LLVMCLANG_VERSION.zip
unzip -qq llvm-project-llvmorg-$LLVMCLANG_VERSION.zip
\rm llvm-project-llvmorg-$LLVMCLANG_VERSION.zip

cd llvm-project-llvmorg-$LLVMCLANG_VERSION

cmake -G Ninja -S ./llvm -B build -DCMAKE_BUILD_TYPE=Release -DLLVM_ENABLE_PROJECTS=clang
cmake --build build -t llvm-tblgen clang-tblgen

export DLLVMCLANG_LLVM_TABLEGEN=-DLLVMCLANG_LLVM_TABLEGEN=$PWD/build/bin/llvm-tblgen
export DLLVMCLANG_CLANG_TABLEGEN=-DLLVMCLANG_CLANG_TABLEGEN=$PWD/build/bin/clang-tblgen
